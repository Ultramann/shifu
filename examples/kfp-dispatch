# /bin/sh

. "$(dirname "$0")"/shifu || exit 1

kfp_dispatch_cmd() {
  shifu_cmd_name kfp-dispatch
  shifu_cmd_subs quote_cmd advice_cmd

  shifu_cmd_arg -l --loud  -- LOUD  false true "Perform action loudly!"
  shifu_cmd_arg -q --quiet -- QUIET false true "Try to perform action quietly."
}

quote_cmd() {
  shifu_cmd_name quote
  shifu_cmd_func kfp_quote

  shifu_cmd_arg -- CHARACTER "Select character to see quote: oogway, shifu, po."
}

advice_cmd() {
  shifu_cmd_name advice
  shifu_cmd_func kfp_advice

  shifu_cmd_arg -- CHARACTER "Select character to see quote: oogway, shifu, po."
}

kfp_quote() {
  shifu_parse_args quote_cmd "$@"

  case "$CHARACTER" in
    oogway) string="One often meets his destiny on the road he takes to avoid it." ;;
    shifu) string="There is now a level zero." ;;
    po) string="I love kung fuuuuuu!!!" ;;
    *) echo "Unknown option $1"; exit 1 ;;
  esac

  [ "$LOUD" = true ] && string=$(echo "$string" | awk '{ print toupper($0) }')
  [ "$QUIET" = true ] && string="$string shhhh!!"
  echo "$string"
}

kfp_advice() {
  shifu_parse_args advice_cmd "$@"

  case "$CHARACTER" in
    oogway) string="Noodles; don't noodles. You are too focused on what was and what will be." ;;
    shifu) string="Anything is possible when you have inner peace." ;;
    po) string="You have to believe in yourself. That's the secret." ;;
    *) echo "Unknown option $1"; exit 1 ;;
  esac

  [ "$LOUD" = true ] && string=$(echo "$string" | awk '{ print toupper($0) }')
  [ "$QUIET" = true ] && string="$string shhhh!!"
  echo "$string"
}

shifu_run_cmd kfp_dispatch_cmd "$@"
